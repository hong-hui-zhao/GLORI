**GLORIï¼ˆGlyoxal and Nitrite-mediated deamination for quantitative mâ¶A mappingï¼‰
##  GLORI å…¨æµç¨‹æ¦‚è§ˆ

GLORI çš„åˆ†ææµç¨‹å¯ä»¥åˆ†ä¸ºå››ä¸ªä¸»è¦é˜¶æ®µï¼š

| é˜¶æ®µ  | åç§°                                          | ä¸»è¦å†…å®¹                      |
| --- | ------------------------------------------- | ------------------------- |
| â‘    | **åŸå§‹æµ‹åºæ•°æ®é¢„å¤„ç†ï¼ˆPreprocessingï¼‰**                | å»æ¥å¤´ã€è´¨é‡æ§åˆ¶ã€å»é‡ã€å»æ‰UMIç­‰        |
| â‘¡   | **åŸºå› ç»„ä¸æ³¨é‡Šæ–‡ä»¶å‡†å¤‡ï¼ˆAnnotation & Index Buildingï¼‰** | ä¸‹è½½ã€ç»Ÿä¸€æŸ“è‰²ä½“åã€æ„å»ºè½¬æ¢åçš„åŸºå› ç»„/è½¬å½•ç»„ç´¢å¼• |
| â‘¢   | **mâ¶Aä½ç‚¹å®šé‡åˆ†æï¼ˆRead Alignment & mâ¶A Callingï¼‰** | æ¯”å¯¹åºåˆ—å¹¶è®¡ç®—æ¯ä¸ªä½ç‚¹çš„A-to-Gè½¬æ¢ç‡     |
| â‘£   | **å¯¹ç…§æ ·æœ¬åˆ†æï¼ˆUntreated Sample Alignmentï¼‰**      | æœªå¤„ç†æ ·æœ¬çš„æ¯”å¯¹ï¼Œç”¨äºåŸºå› è¡¨è¾¾åˆ†ææˆ–èƒŒæ™¯æ¯”è¾ƒ    |

---

##  â‘  åŸå§‹æµ‹åºæ•°æ®é¢„å¤„ç†

###  é€‰æ‹©ä¸åŒç±»å‹çš„æ–‡åº“ï¼š

GLORI æ”¯æŒä¸¤ç§æ–‡åº“ç±»å‹çš„é¢„å¤„ç†æ–¹å¼ï¼š

| æ–‡åº“ç±»å‹                   | é€‰é¡¹           | ç‰¹ç‚¹                             | ä¸»è¦å·®åˆ«            |
| ---------------------- | ------------ | ------------------------------ | --------------- |
| eCLIP library          | **Option A** | å¸¦æœ‰ **5â€²ç«¯UMIæ ‡ç­¾**ï¼Œéœ€è¦å»é™¤UMIå¹¶å»é‡     | å…ˆå»æ¥å¤´ã€å†å»é‡ã€å†å»æ‰UMI |
| NEB #E7300 kit library | **Option B** | æ ‡å‡†æ–‡åº“ï¼Œæ— UMIï¼Œåªéœ€å»æ¥å¤´ã€è´¨é‡æ§åˆ¶ã€å‰ªé™¤3â€²ç«¯1ä¸ªç¢±åŸº | ç®€å•æ¸…æ´—æµç¨‹          |
https://github.com/FelixKrueger/TrimGalore
https://journal.embnet.org/index.php/embnetjournal/article/view/200/458
---

### **(A) eCLIP æ–‡åº“é¢„å¤„ç†æ­¥éª¤**

| æ­¥éª¤             | å‘½ä»¤                                                                                                                                                | å·¥å…·                                      | åŠŸèƒ½è¯´æ˜               |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- | ------------------ |
| 1ï¸âƒ£ å»æ¥å¤´ & è´¨é‡æ§åˆ¶ | `$trim_galore-q20--stringency1-e0.3--length{length(5'UMI)+25nt}\<br>--path_to_cutadapt {cutadapter} --dont_gzip -o {output_dir1} <br>{inputfile}` | **Trim Galore (v0.6.6)** + **Cutadapt** | å»é™¤ä½è´¨é‡ç¢±åŸºï¼ˆQ<20ï¼‰ä¸æ¥å¤´åºåˆ— |
| 2ï¸âƒ£ å»é‡å¤        | `$seqkit rmdup -j {Thread} -s -D {output_dupname} {filter_file1} \> {filter_file2}`                                                               | **SeqKit**                              | åŸºäºåºåˆ—å’ŒUMIå»é™¤PCRé‡å¤    |
| 3ï¸âƒ£ å»æ‰5â€²ç«¯UMI   | `$fastx_trimmer -Q 33 -f {length(5'UMI) +1nt} -i {filter_file2} \-o {filter_file3}`                                                               | **FASTX toolkit**                       | åˆ é™¤UMIéƒ¨åˆ†ï¼Œä¿ç•™çœŸå®åºåˆ—     |
![[Pasted image 20251012143554.png]]

----
### Option A  è§£é‡Š
| å‚æ•°                                | å«ä¹‰                                                        | åœ¨ GLORI ä¸­çš„ä½œç”¨                                                |
| --------------------------------- | --------------------------------------------------------- | ----------------------------------------------------------- |
| `trim_galore`                     | ä¸»ç¨‹åºï¼ŒåŸºäº **Cutadapt** å’Œ **FastQC** çš„è‡ªåŠ¨åŒ–å°è£…ï¼Œç”¨äºæ¸…æ´—æµ‹åºreadsã€‚      | è‡ªåŠ¨å®Œæˆå»æ¥å¤´ + è´¨é‡å‰ªåˆ‡ã€‚                                             |
| `-q 20`                           | **è´¨é‡é˜ˆå€¼**ã€‚ä¿®å‰ªæ‰ Phred è´¨é‡å€¼ < 20 çš„ç¢±åŸºï¼ˆé”™è¯¯ç‡ â‰¥1%ï¼‰ã€‚                 | å»é™¤ä½è´¨é‡ç¢±åŸºï¼Œå‡å°‘å‡é˜³æ€§ A/G è½¬åŒ–ã€‚                                       |
| `--stringency 1`                  | **æ¥å¤´åŒ¹é…ä¸¥æ ¼åº¦**ã€‚è¦æ±‚è‡³å°‘1ä¸ªç¢±åŸºé‡å å³å¯è®¤ä¸ºæ˜¯adapterã€‚                       | æ”¾å®½æ£€æµ‹ï¼Œé¿å…GLORIçŸ­readsä¸­æ¥å¤´æ— æ³•è¯†åˆ«ã€‚                                  |
| `-e 0.3`                          | **æœ€å¤§é”™é…ç‡** (error rate â‰¤0.3)ã€‚                              | è¦æ±‚è‡³å°‘1ä¸ªç¢±åŸºé‡å å³å¯è®¤ä¸ºæ˜¯adapterã€‚                                     |
| `--length {length(5'UMI)+25nt}`   | **æœ€çŸ­ä¿ç•™é•¿åº¦**ã€‚å°äºæ­¤é•¿åº¦çš„readsä¼šè¢«ä¸¢å¼ƒã€‚                               | ç¡®ä¿å»é™¤UMIåä»ä¿ç•™ â‰¥25nt çœŸæ­£åºåˆ—ç”¨äºæ¯”å¯¹ã€‚<br>ä¾‹å¦‚ï¼šUMI=10bp â†’ `--length 35`ã€‚ |
| `--path_to_cutadapt {cutadapter}` | æŒ‡å®š **Cutadapt ç¨‹åºè·¯å¾„**ã€‚                                     | å‘Šè¯‰ Trim Galore ä½¿ç”¨å“ªä¸ª cutadapt ç¨‹åºæ‰§è¡Œæ ¸å¿ƒå‰ªåˆ‡ã€‚                      |
| `--dont_gzip`                     | ä¸å‹ç¼©è¾“å‡ºæ–‡ä»¶ï¼ˆé»˜è®¤æ˜¯ `.fq.gz`ï¼‰ã€‚                                    | ä¿æŒè¾“å‡ºä¸º `.fastq` æ ¼å¼ï¼Œæ–¹ä¾¿åç»­ UMI å¤„ç†è„šæœ¬ç›´æ¥è¯»å–ã€‚                        |
| `-o {output_dir1}`                | è¾“å‡ºç›®å½•ã€‚                                                     | æŒ‡å®šç»“æœè¾“å‡ºæ–‡ä»¶å¤¹ã€‚                                                  |
| `{inputfile}`                     | è¾“å…¥æ–‡ä»¶ã€‚                                                     | åŸå§‹æµ‹åºreadsï¼ˆå¦‚ `.fastq.gz`ï¼‰ã€‚                                   |
| å‚æ•°                                | ä½œç”¨                                                        |                                                             |
| `-j {Thread}`                     | æŒ‡å®šä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼ŒåŠ å¿«å¤„ç†é€Ÿåº¦ã€‚`{Thread}` æ˜¯ä½ å¸Œæœ›ä½¿ç”¨çš„ CPU æ ¸å¿ƒæ•°                |                                                             |
| `-s`                              | æŒ‰åºåˆ—æœ¬èº«å»é‡ï¼ˆsequence-based deduplicationï¼‰ï¼Œä¸è€ƒè™‘åºåˆ—åç§°             | å¦‚æœä¸åŠ  -sï¼Œé»˜è®¤å¯èƒ½ä¼š æŒ‰ç…§åºåˆ—å†…å®¹ + åºåˆ—åç§°ä¸€èµ·å»é‡ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿åºåˆ—ç›¸åŒï¼Œä½†åå­—ä¸åŒï¼Œä¹Ÿä¼šè¢«ä¿ç•™      |
| `-D {output_dupname}`             | å°†é‡å¤åºåˆ—å†™å…¥ `{output_dupname}` æ–‡ä»¶ï¼Œæ–¹ä¾¿æ£€æŸ¥æˆ–ç»Ÿè®¡                     |                                                             |
| `{filter_file1}`                  | è¾“å…¥æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯å»é‡å‰çš„ FASTA/FASTQ æ–‡ä»¶                               |                                                             |
| `{filter_file2}`                  | è¾“å‡ºæ–‡ä»¶ï¼Œå»é‡åçš„åºåˆ—å†™å…¥è¿™ä¸ªæ–‡ä»¶                                         |                                                             |
| å‚æ•°                                | ä½œç”¨                                                        |                                                             |
| `-Q 33`                           | æŒ‡å®š FASTQ æ–‡ä»¶çš„è´¨é‡ç¼–ç ä¸º **Phred+33**ï¼ˆASCII 33 å¯¹åº”è´¨é‡å€¼ 0ï¼‰          | åœ¨å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œè¯¥å‘½ä»¤å¹¶æ²¡æœ‰è¿™ä¸ªå‚æ•°                                           |
| `-f {length(5'UMI)+1nt}`          | ä» reads **ç¬¬ {length(5'UMI)+1} ä¸ªç¢±åŸºå¼€å§‹ä¿ç•™**ï¼ˆå³å‰ªæ‰å‰ç«¯ UMI + 1 ntï¼‰ |                                                             |
| `-i {filter_file2}`               | è¾“å…¥æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯å»é‡åçš„ FASTQ æ–‡ä»¶                                     |                                                             |
| `-o {filter_file3}`               | è¾“å‡ºæ–‡ä»¶ï¼Œä¿å­˜å‰ªåˆ‡åçš„åºåˆ—                                             |                                                             |
![[Pasted image 20251012145356.png]]
### **(B) NEB #E7300 æ–‡åº“é¢„å¤„ç†æ­¥éª¤**

| æ­¥éª¤             | å‘½ä»¤                                                                                                                                          | å·¥å…·                         | åŠŸèƒ½è¯´æ˜            |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------- | --------------- |
| 1ï¸âƒ£ å»æ¥å¤´ & è´¨é‡æ§åˆ¶ | `$trim_galore -q 20 -a AGATCGGAAGAGCA --stringency 1 --length 20 \--path_to_cutadapt {cutadapter} --dont_gzip -o {output_dir1} {inputfile}` | **Trim Galore + Cutadapt** | å»é™¤adapterå’Œä½è´¨é‡ç‰‡æ®µ |
| 2ï¸âƒ£ å»é™¤3â€²ç«¯1ä¸ªç¢±åŸº  | `$fastx_trimmer -Q 33 -t 1 -i {filter_file1} -o {filter_file2}`                                                                             | **FASTX toolkit**          | å»æ‰3â€²ç«¯å¯èƒ½çš„æµ‹åºåå·®    |
-t æŒ‡ å»æ‰3â€˜ç«¯çš„ä¸€ä¸ªç¢±åŸº

NEB æ–‡åº“æ„å»ºä¸­æœ‰ æœ«ç«¯ä¿®å¤å’ŒåŠ  Aï¼Œå®¹æ˜“åœ¨æµ‹åºè¯»æ®µæœ«ç«¯å‡ºç°äººå·¥ç¢±åŸºã€‚
eCLIP æ–‡åº“æ„å»ºåˆ™é‡‡ç”¨ ç›´æ¥è¿æ¥æ¥å¤´ï¼ŒRNA ç‰‡æ®µæœ«ç«¯ä¿æŒåŸå§‹çŠ¶æ€ï¼Œä¸ä¼šå¤šå‡ºç¢±åŸºã€‚



---

##  â‘¡ å‡†å¤‡æ³¨é‡Šä¸åŸºå› ç»„ç´¢å¼•

è¿™ä¸€æ­¥æ˜¯ GLORI çš„åŸºç¡€ã€‚ä½ éœ€è¦å‡†å¤‡ **åŸºå› ç»„åºåˆ—ï¼ˆ.faï¼‰**ã€**æ³¨é‡Šæ–‡ä»¶ï¼ˆ.gtfï¼‰** å¹¶æ„å»º **Aâ†’Gè½¬æ¢ç‰ˆæœ¬** çš„ç´¢å¼•æ–‡ä»¶ã€‚

---

### **Step 124. ä¸‹è½½å¹¶ç»Ÿä¸€æ³¨é‡Šæ–‡ä»¶**

| æ­¥éª¤          | å·¥å…·                               | åŠŸèƒ½è¯´æ˜                              |
| ----------- | -------------------------------- | --------------------------------- |
| ä¸‹è½½ GTF æ³¨é‡Šæ–‡ä»¶ | `wget`                           | ä» NCBI RefSeq ä¸‹è½½äººç±»åŸºå› ç»„æ³¨é‡Šï¼ˆGRCh38ï¼‰   |
| ç»Ÿä¸€æŸ“è‰²ä½“å      | `change_UCSCgtf.py`ï¼ˆGLORI-toolsï¼‰ | ç»Ÿä¸€åŸºå› ç»„å’Œæ³¨é‡Šæ–‡ä»¶çš„æŸ“è‰²ä½“å‘½åï¼ˆä¾‹å¦‚å°†â€œchr1â€â†”â€œ1â€ç»Ÿä¸€ï¼‰ |

---

### **Step 125. æ„å»ºåŸºå› ç»„ç´¢å¼•**

| æ­¥éª¤                    | å·¥å…·                                   | åŠŸèƒ½è¯´æ˜                                   |
| --------------------- | ------------------------------------ | -------------------------------------- |
| ä¸‹è½½åŸºå› ç»„                 | `wget`                               | ä» UCSC ä¸‹è½½ `hg38.fa`                    |
| æ„å»ºAâ†’Gè½¬æ¢ç‰ˆåŸºå› ç»„ + åå‘äº’è¡¥åŸºå› ç»„ | `build_genome_index.py`ï¼ˆGLORI-toolsï¼‰ | åˆ›å»ºä¸¤ä¸ªç‰ˆæœ¬ï¼šforward & reverse strand Aâ†’Gè½¬æ¢ç‰ˆ |
| æ„å»º STAR ç´¢å¼•            | **STAR (v2.7.5c)**                   | ä¸ºä¸¤ä¸ªåŸºå› ç»„ç‰ˆæœ¬æ„å»ºç´¢å¼•ç”¨äºåç»­æ¯”å¯¹                     |

---

### **Step 126. æ„å»ºè½¬å½•ç»„ç´¢å¼•**

| æ­¥éª¤                 | å·¥å…·                                                  | åŠŸèƒ½è¯´æ˜                                    |
| ------------------ | --------------------------------------------------- | --------------------------------------- |
| ä¸‹è½½è½¬å½•ç»„æ–‡ä»¶ (.fna)     | `wget`                                              | ä» NCBI RefSeq ä¸‹è½½                        |
| é€‰å–æœ€é•¿è½¬å½•æœ¬            | `gtf2anno.py` + `selected_longest_transcrpts_fa.py` | ä¿ç•™æ¯ä¸ªåŸºå› çš„æœ€é•¿isoformï¼Œæ„å»ºæœ€ç»ˆè½¬å½•ç»„                |
| æ„å»º Aâ†’G è½¬æ¢ç‰ˆè½¬å½•ç»„ & ç´¢å¼• | `build_transcriptome_index.py`                      | åˆ›å»º Aâ†’G è½¬æ¢çš„è½¬å½•ç»„å¹¶æ„å»º **Bowtie (v1.3.0)** ç´¢å¼• |

---

### **Step 127 (å¯é€‰). æ„å»ºå•ç¢±åŸºåˆ†è¾¨ç‡æ³¨é‡Š**

| æ­¥éª¤       | å·¥å…·                                       | åŠŸèƒ½è¯´æ˜                              |
| -------- | ---------------------------------------- | --------------------------------- |
| åŸºå› ç»„ç¢±åŸºçº§æ³¨é‡Š | `anno_to_base.py`                        | æŠŠ GTF æ³¨é‡Šè½¬åŒ–ä¸ºå•ç¢±åŸºåˆ†è¾¨ç‡æ³¨é‡Š               |
| åŸºå› åˆ—è¡¨æ–‡ä»¶   | `gtf2genelist.py`                        | ç”ŸæˆåŒ…å«åŸºå› æ³¨é‡Šçš„åˆ—è¡¨æ–‡ä»¶                     |
| å»é™¤å†—ä½™æ³¨é‡Š   | `anno_to_base_remove_redundance_v1.0.py` | å»æ‰é‡å¤æ³¨é‡Šï¼Œå¾—åˆ°éå†—ä½™ç‰ˆæœ¬ï¼ˆç”¨äºgene-specificåˆ†æï¼‰ |

---

## ğŸ§  â‘¢ è¯»å–æ¯”å¯¹ä¸ mâ¶A ä½ç‚¹å®šé‡

ä¸»ç¨‹åºï¼š**`run_GLORI.py`**
GLORI å°†æ¯”å¯¹ + mâ¶Aä½ç‚¹å®šé‡æ•´åˆä¸ºä¸€æ­¥ã€‚

æœ‰ä¸¤ç§æ¨¡å¼ï¼š

| æ¨¡å¼                    | èƒŒæ™¯æ ¡æ­£æ–¹æ³•              | ä½¿ç”¨çš„æ–‡ä»¶                  | æ¨èç”¨é€”          |
| --------------------- | ------------------- | ---------------------- | ------------- |
| **(A)** åŸºå› ç‰¹å¼‚æ€§ Aâ†’G è½¬æ¢ç‡ | åŸºäºå•åŸºå› è½¬æ¢ç‡æ–‡ä»¶ï¼ˆstep127ï¼‰ | `{.noredundance.base}` | ç²¾å‡†åˆ†æå•åŸºå› ä½ç‚¹     |
| **(B)** è½¬å½•ç»„æ•´ä½“è½¬æ¢ç‡      | åŸºäºå…¨è½¬å½•ç»„å¹³å‡è½¬æ¢ç‡         | æ— éœ€å•åŸºå› æ–‡ä»¶                | å¸¸è§„mâ¶A calling |

---

### **(A) åŸºå› ç‰¹å¼‚æ€§åˆ†æå‘½ä»¤**

```bash
python run_GLORI.py -i {GLORI-tools} -q {clean_reads} -T {threads} \
-f {hg38}.AG_conversion.fa -f2 {hg38.fa} \
-rvs {hg38}.rvsCom.fa -Tf {Transcriptome_Index} \
-a {GRCh38_prefix}_genomic.gtf_change2Ens.tbl2 \
-b {GRCh38_prefix}_genomic.gtf_change2Ens.tbl2.noredundance.base \
-pre {prefix} -o {output_dir} --combine --rvs_fac
```

### **(B) è½¬å½•ç»„æ•´ä½“åˆ†æå‘½ä»¤**

```bash
python run_GLORI.py -i {GLORI-tools} -q {clean_reads} -T {threads} \
-f {hg38}.AG_conversion.fa -f2 {hg38.fa} \
-rvs {hg38}.rvsCom.fa -Tf {Transcriptome_Index} \
-a {GRCh38_prefix}_genomic.gtf_change2Ens.tbl2 \
-pre {prefix} -o {output_dir} --combine --rvs_fac
```

---

## ğŸ§© â‘£ å¯¹ç…§æ ·æœ¬ï¼ˆæœªGLORIå¤„ç†ï¼‰æ¯”å¯¹åˆ†æ

è¿™ä¸€æ­¥ç”¨äº**èƒŒæ™¯æˆ–è¡¨è¾¾é‡åˆ†æ**ï¼Œä¸ä¼šè°ƒç”¨mâ¶Aä½ç‚¹ï¼š

```bash
python run_GLORI.py -i {GLORI-tools} -q {file} -T {threads} \
-f {genome.fa} -Tf {Transcriptome_Index} \
-a {GRCh38_prefix}_genomic.gtf_change2Ens.tbl2 \
-pre {prefix} -o {outputdir} --combine --untreated
```

è¾“å‡º `.bam` æ–‡ä»¶å¯ç”¨äºè¡¨è¾¾åˆ†ææˆ–ä¸GLORIæ ·æœ¬æ¯”è¾ƒã€‚

---

## ğŸ§© æ€»ç»“ï¼šGLORIåˆ†æå®Œæ•´æµç¨‹è¡¨

| é˜¶æ®µ                | ä¸»è¦å‘½ä»¤ / è„šæœ¬                                                                | å·¥å…·                            | ä¸»è¦åŠŸèƒ½                     |
| ----------------- | ------------------------------------------------------------------------ | ----------------------------- | ------------------------ |
| **â‘  æ•°æ®é¢„å¤„ç†**       | trim_galore / seqkit / fastx_trimmer                                     | Trim Galore, SeqKit, FASTX    | å»adapterã€è´¨é‡æ§åˆ¶ã€å»é‡å¤ã€å»UMI   |
| **â‘¡ ä¸‹è½½æ³¨é‡Šä¸æ„å»ºç´¢å¼•**   | change_UCSCgtf.py / build_genome_index.py / build_transcriptome_index.py | GLORI-tools, STAR, Bowtie     | ç»Ÿä¸€æ³¨é‡Šã€æ„å»ºAâ†’Gè½¬åŒ–ç´¢å¼•           |
| **â‘¢ æ„å»ºå•ç¢±åŸºæ³¨é‡Šï¼ˆå¯é€‰ï¼‰** | anno_to_base.py / anno_to_base_remove_redundance_v1.0.py                 | GLORI-tools                   | ç”Ÿæˆå•ç¢±åŸºæ³¨é‡Šç”¨äºgene-specificåˆ†æ |
| **â‘£ mâ¶Aä½ç‚¹å®šé‡åˆ†æ**   | run_GLORI.py                                                             | GLORI-tools (æ•´åˆSTAR + Bowtie) | è¯»å–æ¯”å¯¹ + mâ¶Aä½ç‚¹è¯†åˆ«ä¸å®šé‡        |
| **â‘¤ å¯¹ç…§æ ·æœ¬åˆ†æ**      | run_GLORI.py --untreated                                                 | GLORI-tools                   | æ¯”å¯¹æœªå¤„ç†æ ·æœ¬ä»¥ä¾›è¡¨è¾¾åˆ†æ            |

